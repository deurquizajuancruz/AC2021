EOI EQU 20H
INT2 EQU 26H
HAND EQU 40H

ORG 28
IPHAND DW 3000H

ORG 1000H
MSJ DB "INGRESE LOS 5 CARACTERES: "
FIN1 DB ?
FINAL DB 0
ORG 1100H
CARAC DB ?

ORG 3000H
IN AL,HAND+1
AND AL,7FH
OUT HAND+1,AL
MOV BX,OFFSET CARAC
POLL: IN AL,HAND+1
AND AL,1
JNZ POLL
MOV AL,[BX]
OUT HAND,AL
INC BX
DEC CX
JNZ POLL
DEC BX
MOV CX,5
POLL2: IN AL,HAND+1
AND AL,1
JNZ POLL2
MOV AL,[BX]
OUT HAND,AL
DEC BX
DEC CX
CMP CX,0
JNZ POLL2
INC FINAL
IRET

ORG 2000H
CLI
MOV BX,OFFSET MSJ
MOV AL,OFFSET FIN1 - OFFSET MSJ
INT 7
MOV CX,0
MOV BX,OFFSET CARAC
LEER: INT 6
INC CX
INC BX
CMP CX,5
JNZ LEER
MOV AL,0FBH
OUT EOI+1,AL ; HABILITO LA INTERRUPCION POR HANDSHAKE
MOV AL,7
OUT INT2,AL
MOV AL,80H
OUT HAND+1,AL
STI
LAZO: CMP FINAL,1
      JNZ LAZO
INT 0
END