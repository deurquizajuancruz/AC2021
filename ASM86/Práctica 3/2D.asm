EOI EQU 20H
INT0 EQU 24H
PA EQU 30H
PB EQU 31H
CA EQU 32H
CB EQU 33H

ORG 16
IDF1O DW 3000H

ORG 1000H
MENSAJE DB "INGRESE LA CANTIDAD DE CARACTERES A INGRESAR(MAXIMO 9): "
FIN1 DB ?
MENSAJE2 DB "INGRESE LOS CARACTERES: "
FIN2 DB ?
CANTIDAD DB ?
FINAL DB 0
ORG 1100H
CARACTER DB ?


ORG 3000H
MOV BX,OFFSET CARACTER
POLL: IN AL,PA
AND AL,1
JNZ POLL
IMP: MOV AL,[BX]
OUT PB,AL
IN AL,PA
OR AL,2
OUT PA,AL
IN AL,PA
AND AL,0FDH
OUT PA,AL
INC BX
DEC DH
JNZ POLL
INC FINAL
MOV AL,0FFH
OUT EOI,AL
MOV AL,20H
OUT EOI,AL ; SE FINALIZA LA INTERRUPCION
IRET

ORG 2000H
CLI
MOV AL,0FEH
OUT EOI+1,AL ; HABILITO LA INTERRUPCION POR F10
MOV AL,4
OUT INT0,AL ; ID DE INTERRUPCION
MOV AL,1
OUT CA,AL ; LE PASO 1 A CA
DEC AL
OUT CB,AL ; LE PASO 0 A CB
IN AL,PA
AND AL,0FDH
OUT PA,AL ; FORZO EL BIT DE STROBE A 0
MOV BX,OFFSET MENSAJE
MOV AL, OFFSET FIN1 - OFFSET MENSAJE
INT 7
MOV BX,OFFSET CANTIDAD
INT 6
MOV DL,[BX]
SUB DL,30H
MOV DH,DL
MOV BX,OFFSET MENSAJE2
MOV AL,OFFSET FIN2 - OFFSET MENSAJE2
INT 7
MOV BX,OFFSET CARACTER
LEER: INT 6
INC BX
DEC DL
JNZ LEER
STI
LAZO: CMP FINAL,1
      JNZ LAZO
INT 0
END
